.libPaths()
lapply(.libPaths(), list.dirs, recursive = FALSE, full.names = FALSE)
proj_sitrep()
?proj_sitrep
??proj_sitrep
library(devtools)
proj_sitrep()
proj_get()
proj_sitrep()
install.packages("exactextractr")
library(sf)
library(dplyr)
library(ggplot2)
#library(rgdal)
#library(terra)
library(raster)
library(exactextractr)
source("../../../Tools/beacons/R/ksPlot.R")
source("../../../Tools/beacons/R/bcPlot.R")
source("../../../Tools/beacons/R/metricsNetHydro_sf.R")
setwd("C:/Users/MAEDW7/Dropbox (BEACONs)/KBA Case Study/eco23/scripts")
source("../../../Tools/beacons/R/ksPlot.R")
source("../../../Tools/beacons/R/bcPlot.R")
source("../../../Tools/beacons/R/metricsNetHydro_sf.R")
criteria = c("cmi", "gpp", "led", "nalc", "cmi20")
# set up bc plot classes
lcc.lab <- list(nalc1="Temperate or sub-polar needleleaf forest",
nalc2="Sub-polar taiga needleleaf forest",
nalc3="Tropical or sub-tropical broadleaf evergreen forest",
nalc4="Tropical or sub-tropical broadleaf deciduous forest",
nalc5="Temperate or sub-polar broadleaf deciduous forest",
nalc6="Mixed forest",
nalc7="Tropical or sub-tropical shrubland",
nalc8="Temperate or sub-polar shrubland",
nalc9="Tropical or sub-tropical grassland",
nalc10="Temperate or sub-polar grassland",
nalc11="Sub-polar or polar shrubland-lichen-moss",
nalc12="Sub-polar or polar grassland-lichen-moss",
nalc13="Sub-polar or polar barren-lichen-moss",
nalc14="Wetland",
nalc15="Cropland",
nalc16="Barren land",
nalc17="Urban and built-up",
nalc18="Water",
nalc19="Snow and ice")
eco <- "eco23_kba_zone2"
net_shp <- st_read("../networks/zone2_pb2pa1.shp")
repDir <- "../representation/target_based_output/"
net_shp <- st_read("../networks/eco23_kba_zone2/zone2_pb2pa1.shp")
repDir <- "../representation/target_based_output/"
upstream_table <- read_csv("../builder/output/eco23_kba_zone2_i0/2021_12_13_1401_ROW_BLIT_i0_t100_UPSTREAM_CATCHMENTS_COLUMN.csv")
pa1_upstream <- read_csv("../pas/zone2/PA_1 (use this one)/zone2_PA_1_catch_UP_column.csv")
pa1_upstream$OID <- 1:nrow(pa1_upstream)
names(pa1_upstream) <- c("PA_1", "OID")
upstream_table <- upstream_table %>%
full_join(pa1_upstream, by = "OID")
benchmark_table <- read_csv("../builder/output/eco23_kba_zone2_i0/2021_12_13_1401_ROW_BLIT_i0_t100_COLUMN_All_Unique_BAs.csv")
pa1_catchments <- read_csv("../pas/zone2/PA_1 (use this one)/zone2_PA_1_catch_column.csv")
pa1_catchments$OID <- 1:nrow(pa1_catchments)
names(pa1_catchments) <- c("PA_1", "OID")
benchmark_table <- benchmark_table %>%
full_join(pa1_catchments, by = "OID")
upstream_table <- read_csv("../builder/output/eco23_kba_zone2_i0/2021_12_13_1401_ROW_BLIT_i0_t100_UPSTREAM_CATCHMENTS_COLUMN.csv")
library(tidyverse)
upstream_table <- read_csv("../builder/output/eco23_kba_zone2_i0/2021_12_13_1401_ROW_BLIT_i0_t100_UPSTREAM_CATCHMENTS_COLUMN.csv")
pa1_upstream <- read_csv("../pas/zone2/PA_1 (use this one)/zone2_PA_1_catch_UP_column.csv")
pa1_upstream$OID <- 1:nrow(pa1_upstream)
names(pa1_upstream) <- c("PA_1", "OID")
upstream_table <- upstream_table %>%
full_join(pa1_upstream, by = "OID")
benchmark_table <- read_csv("../builder/output/eco23_kba_zone2_i0/2021_12_13_1401_ROW_BLIT_i0_t100_COLUMN_All_Unique_BAs.csv")
pa1_catchments <- read_csv("../pas/zone2/PA_1 (use this one)/zone2_PA_1_catch_column.csv")
pa1_catchments$OID <- 1:nrow(pa1_catchments)
names(pa1_catchments) <- c("PA_1", "OID")
benchmark_table <- benchmark_table %>%
full_join(pa1_catchments, by = "OID")
ref_shp <- st_read(paste0("../kba/", eco, ".shp")) %>%
summarise(geometry = st_union(geometry))
ref_shp
# set outdir for dissimilarity plots
plotOutDir <- paste0("../networks/", eco, "/plots/")
crit<-"nalc"
ras <- raster("../../criteria/nalc2015/CAN_NALCMS_2015_v2_land_cover_30m_wwf9_Bprj_nearest.tif")
class_vals <- c(1,2,5,6,8,9,10,11,12,13,14,16,18,19)} # drop 15 and 17 - urban and cropland
cellsize <- res(ras)[1] / 1000
cellarea <- cellsize * cellsize
cellsize
ras_ext <- exact_extract(ras, ref_shp) # outputs list of length 1 containing df of values
crit<-"cmi"
ras <- raster("../../criteria/cmi/NORM_6190_CMIpm_wwf9_Bprj_nearest_reclass_50m.tif")
ras
ras_ext <- exact_extract(ras, ref_shp) # outputs list of length 1 containing df of values
?exact_extract
rast <- raster::raster(matrix(1:100, ncol=10), xmn=0, ymn=0, xmx=10, ymx=10)
poly <- sf::st_as_sfc('POLYGON ((2 2, 7 6, 4 9, 2 2))')
exact_extract(rast, poly, 'mean')
